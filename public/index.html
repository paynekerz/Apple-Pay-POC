<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>IQPro Apple Pay • PoC</title>

    
    <!-- <script
      src="https://applepay.cdn-apple.com/jsapi/1.latest/apple-pay-sdk.js"
      crossorigin
    ></script> -->

    <script src="https://sandbox.basysiqpro.com/tokenizer/tokenizer.js"></script>
    <script src="/tokenizer-example.js" defer></script>

    <style>
      body {
        font-family: ui-sans-serif, system-ui;
        padding: 2rem;
        max-width: 760px;
        margin: 0 auto;
      }
      .row {
        margin: 1rem 0;
      }
      apple-pay-button {
        --apple-pay-button-width: 280px;
        --apple-pay-button-height: 44px;
      }
      .log {
        background: #0b1020;
        color: #e6edf3;
        padding: 1rem;
        border-radius: 8px;
        white-space: pre-wrap;
      }
      .ok {
        color: #0a8f3a;
      }
      .bad {
        color: #b3261e;
      }
      button {
        padding: 0.6rem 1rem;
        border-radius: 8px;
        border: 1px solid #ddd;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <h1>Apple Pay PoC (IQPro Sandbox)</h1>

    <!-- Simple Domain Registration: simulate verification UI -->
    <section class="row">
      <h2>Domain Registration</h2>
      <p>
        Place your
        <code>apple-developer-merchantid-domain-association.txt</code> file in
        <code>public/.well-known/</code>, then click the button below.
      </p>
      <button id="btn-check">Check Verification File</button>
      <span id="verify-status"></span>
    </section>

    <section>
  <h2>Tokenizer</h2>
  <div id="container"></div>
</section>

    <section class="row">
      <h2>Last Response</h2>
      <div id="out" class="log">—</div>
    </section>

    <script>
      document
        .getElementById("btn-check")
        .addEventListener("click", async () => {
          const s = document.getElementById("verify-status");
          try {
            const res = await fetch(
              "/.well-known/apple-developer-merchantid-domain-association.txt",
              { cache: "no-store" }
            );
            if (res.ok) {
              s.innerHTML =
                'Status: <strong class="ok">Verification file accessible ✅</strong>';
            } else {
              s.innerHTML =
                'Status: <strong class="bad">Not found / blocked ❌</strong>';
            }
          } catch (e) {
            s.innerHTML =
              'Status: <strong class="bad">Request error ❌</strong>';
          }
        });
    </script>
  </body>
</html>